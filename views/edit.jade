extends layout

block content
  #wrap
  script(type="text/javascript").
    var docId = '#{docId}';
    var docCollection = 'draft';
    var catalog = '#{doc.catalog}';
    var defaultCatalog = '@#{user.name}';
    var docStatus = '#{doc.status}';
    var parent = '#{doc.parent}';
    var owns = !{owns};
    var owns_catalogs = !{owns_catalogs};
    var writes = !{writes};
    var docMode = 'edit';
    var messages =  !{messages};
    var url = '#{url}';
    window.onunload = function() {
      //alert('Leaving page')
      //TODO: snapshot the document here. (and wait)
    }
  script(type='text/javascript' src='/channel/bcsocket.js')
  script(type='text/javascript' src='/javascript/utils.js')  
  script(type='text/javascript' src='/javascript/main.js')  
